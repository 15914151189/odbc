addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - boost-latest
    packages:
      - g++-5
      - libboost-locale1.55-dev
      - libboost-test1.55-dev
      - libiodbc2
      - libiodbc2-dev
      - libmyodbc
      - libsqliteodbc

language: cpp

compiler:
  - gcc

env:
    - USE_UNICODE=OFF USE_BOOST_CONVERT=OFF
    - USE_UNICODE=OFF USE_BOOST_CONVERT=ON
    - USE_UNICODE=ON  USE_BOOST_CONVERT=OFF
    - USE_UNICODE=ON  USE_BOOST_CONVERT=ON

before_script:
  - sudo odbcinst -i -d -f /usr/share/libmyodbc/odbcinst.ini
  - sudo odbcinst -i -s -l -f ./test/odbc.ini
  - sudo odbcinst -i -s -l -f /usr/share/sqliteodbc/unixodbc.ini
  - cat /etc/odbc.ini
  - cat /etc/odbcinst.ini
  - if [[ "$CXX" == "g++" ]]; then export CXX="g++-5"; fi
  - mkdir build
  - cd build

script:
  - cmake -D NANODBC_USE_UNICODE=${USE_UNICODE} -D NANODBC_USE_BOOST_CONVERT=${USE_BOOST_CONVERT} -D NANODBC_ENABLE_LIBCXX=NO ..
  - make VERBOSE=1 sqlite_check
